!function(){"use strict";var e,t,i,r=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},n=function(e){if("loading"===document.readyState)return"loading";var t=r();if(t){if(e<t.domInteractive)return"loading";if(0===t.domContentLoadedEventStart||e<t.domContentLoadedEventStart)return"dom-interactive";if(0===t.domComplete||e<t.domComplete)return"dom-content-loaded"}return"complete"},s=function(e){var t=e.nodeName;return 1===e.nodeType?t.toLowerCase():t.toUpperCase().replace(/^#/,"")},a=function(e,t){var i="";try{for(;e&&9!==e.nodeType;){var r=e,n=r.id?"#"+r.id:s(r)+(r.classList&&r.classList.value&&r.classList.value.trim()&&r.classList.value.trim().length?"."+r.classList.value.trim().replace(/\s+/g,"."):"");if(i.length+n.length>(t||100)-1)return i||n;if(i=i?n+">"+i:n,r.id)break;e=r.parentNode}}catch(e){}return i},o=-1,c=function(e,t){var i=r(),n="navigate";return o>=0?n="back-forward-cache":i&&(document.prerendering||function(){var e=r();return e&&e.activationStart||0}()>0?n="prerender":document.wasDiscarded?n="restore":i.type&&(n=i.type.replace(/_/g,"-"))),{name:e,value:-1,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:n}},l=function(e,t,i){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},i||{})),r}}catch(e){}},d=function(e,t,i,r){var n,s;return function(a){t.value>=0&&(a||r)&&((s=t.value-(n||0))||void 0===n)&&(n=t.value,t.delta=s,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,i),e(t))}},u=function(e){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e()}))},m=0,h=1/0,f=0,p=function(e){e.forEach((function(e){e.interactionId&&(h=Math.min(h,e.interactionId),f=Math.max(f,e.interactionId),m=f?(f-h)/7+1:0)}))},E=function(){"interactionCount"in performance||e||(e=l("event",p,{type:"event",buffered:!0,durationThreshold:0}))},v=[],b=new Map,g=0,_=function(){return(e?m:performance.interactionCount||0)-g},T=[],w=function(e){if(T.forEach((function(t){return t(e)})),e.interactionId||"first-input"===e.entryType){var t=v[v.length-1],i=b.get(e.interactionId);if(i||v.length<10||e.duration>t.latency){if(i)e.duration>i.latency?(i.entries=[e],i.latency=e.duration):e.duration===i.latency&&e.startTime===i.entries[0].startTime&&i.entries.push(e);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};b.set(r.id,r),v.push(r)}v.sort((function(e,t){return t.latency-e.latency})),v.length>10&&v.splice(10).forEach((function(e){return b.delete(e.id)}))}}},y=function(e){var t=self.requestIdleCallback||self.setTimeout,i=-1;return e=function(e){var t=!1;return function(){t||(e(),t=!0)}}(e),"hidden"===document.visibilityState?e():(i=t(e),u(e)),i},A=[200,500],I=function(e,t){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(t=t||{},function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()}((function(){var i;E();var r,n=c("INP"),s=function(e){y((function(){e.forEach(w);var t,i=(t=Math.min(v.length-1,Math.floor(_()/50)),v[t]);i&&i.latency!==n.value&&(n.value=i.latency,n.entries=i.entries,r())}))},a=l("event",s,{durationThreshold:null!==(i=t.durationThreshold)&&void 0!==i?i:40});r=d(e,n,A,t.reportAllChanges),a&&(a.observe({type:"first-input",buffered:!0}),u((function(){s(a.takeRecords()),r(!0)})),function(e){addEventListener("pageshow",(function(t){t.persisted&&(o=t.timeStamp,e(t))}),!0)}((function(){g=0,v.length=0,b.clear(),n=c("INP"),r=d(e,n,A,t.reportAllChanges)})))})))},O=[],P=new Map,L=[],R=new WeakMap,C=new Map,S=-1,M=function(e){O=O.concat(e),N()},N=function(){S<0&&(S=y(D))},D=function(){C.size>10&&C.forEach((function(e,t){b.has(t)||C.delete(t)})),L=L.slice(-50);var e=new Set(L.concat(v.map((function(e){return R.get(e.entries[0])}))));P.forEach((function(t,i){e.has(i)||P.delete(i)}));var t=new Set;P.forEach((function(e){F(e.startTime,e.processingEnd).forEach((function(e){t.add(e)}))}));for(var r=0;r<50;r++){var n=O[O.length-1-r];if(!n||n.startTime<i)break;t.add(n)}O=Array.from(t),S=-1};T.push((function(e){e.interactionId&&e.target&&!C.has(e.interactionId)&&C.set(e.interactionId,e.target)}),(function(e){var t,r=e.startTime+e.duration;i=Math.max(i,e.processingEnd);for(var n=L.length-1;n>=0;n--)if(t=L[n],Math.abs(r-t)<=8){var s=P.get(t);s.startTime=Math.min(e.startTime,s.startTime),s.processingStart=Math.min(e.processingStart,s.processingStart),s.processingEnd=Math.max(e.processingEnd,s.processingEnd),s.entries.push(e),r=t;break}r!==t&&(L.push(r),P.set(r,{startTime:e.startTime,processingStart:e.processingStart,processingEnd:e.processingEnd,entries:[e]})),(e.interactionId||"first-input"===e.entryType)&&R.set(e,r),N()}));var k,V,F=function(e,t){for(var i,r=[],n=0;i=O[n];n++)if(!(i.startTime+i.duration<e)){if(i.startTime>t)break;r.push(i)}return r};!function(e){e.MARK="mark",e.MEASURE="measure",e.NAVIGATION="navigation",e.RESOURCE="resource",e.LONGTASK="longtask",e.PAINT="paint",e.ELEMENT="element",e.EVENT="event",e.FID="first-input",e.CLS="layout-shift",e.LCP="largest-contentful-paint",e.LOAF="long-animation-frame"}(k||(k={})),function(e){e.NAVIGATION="navigation",e.CSS="css",e.SCRIPT="script",e.XHR="xmlhttprequest",e.FETCH="fetch",e.BEACON="beacon",e.VIDEO="video",e.AUDIO="audio",e.TRACK="track",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.A="a",e.IFRAME="iframe",e.FRAME="frame",e.OTHER="other",e.BODY="body",e.EARLY_HINT="early-hint",e.EMBED="embed",e.ICON="icon",e.LINK="link",e.OBJECT="object",e.ping="ping"}(V||(V={}));const j=".m3u8",H=".ts",G=".mpd",W=/\.(mp4|m4s)$/i,U=/\.(mp4|m4s|m4v|m4a|avi|webm|mkv|wmv|mpg|mov|flv)$/i,Y=/tile\.mp4$/i;var x;function B(e){if(!e)return!1;const t=q(e);return Y.test(t)}function q(e){return e.split("?")[0]}function X(e){const t=function(e){const t=q(e.name);if([V.VIDEO,V.OTHER].includes(e.initiatorType)&&U.test(t))return x.MP4;if([V.FETCH,V.XHR].includes(e.initiatorType)){if(t.endsWith(j))return x.HLS_MANIFEST;if(t.endsWith(H))return x.HLS_CHUNK;if(t.endsWith(G))return x.DASH_MANIFEST;if(W.test(t))return x.DASH_CHUNK}return null}(e);return null!==t}function K(e,t,i){const r=B(e);return!(!r||!t)||!(r||!i)}!function(e){e.MP4="mp4",e.HLS_MANIFEST="hls_manifest",e.HLS_CHUNK="hls_chunk",e.DASH_MANIFEST="dash_manifest",e.DASH_CHUNK="dash_chunk"}(x||(x={}));const $=e=>e.initiatorType===V.XHR||e.initiatorType===V.FETCH,z=(e,t=!1)=>{const i=()=>{"hidden"===document.visibilityState&&(e(),t&&window.removeEventListener("visibilitychange",i))};window.addEventListener("visibilitychange",i),window.addEventListener("beforeunload",(()=>e()))};var J;!function(e){e.START="start",e.END="end"}(J||(J={}));class Q{constructor(e){Object.defineProperty(this,"heldEntries",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sentEntries",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"capacity",{enumerable:!0,configurable:!0,writable:!0,value:20}),this.capacity=void 0!==e.capacity?e.capacity:20}addHeldEntries(e,t=J.END){t===J.START?this.heldEntries.unshift(...e):this.heldEntries.push(...e)}addSentEntries(e){this.sentEntries.push(...e)}deleteHeldEntry(e){return"object"==typeof this.heldEntries[e]&&(this.heldEntries.splice(e,1),!0)}clearHeldEntries(){this.heldEntries=[]}clearSentEntries(){this.sentEntries=[]}isFull(){return this.heldEntries.length>=this.capacity}}const Z={pageCloseEnabled:!0,capacity:20,sendTimeout:3e4,sendMethod:()=>Promise.resolve(!1)};class ee{constructor(e){Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scheduledSendTimer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isOnUnload",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.add=this.add.bind(this),this.config={...Z,...e},this.store=new Q({capacity:this.config.capacity}),this.scheduledSendTimer=((e,t)=>{let i;const r={start(){r.cancel(),i=window.setTimeout(e,t)},cancel(){window.clearTimeout(i),i=void 0}};return r})((()=>this.send()),this.config.sendTimeout),setTimeout((()=>{z(this.flush.bind(this),!0)}))}add(e,{forceSend:t=!1}={}){if(this.isOnUnload)return this.scheduledSendTimer.cancel(),void this.store.addHeldEntries([e]);this.store.addHeldEntries([e]),this.store.isFull()||t?this.flush():this.scheduledSendTimer.start()}flush(){this.scheduledSendTimer.cancel(),this.send()}async send(){const e=this.store.heldEntries.slice();e.length&&(this.config.sendMethod(e),this.store.clearHeldEntries(),this.store.addSentEntries(e))}}function te(e,t){return new Promise((i=>setTimeout((()=>i(t)),e)))}async function ie(e,{timeout:t=50,attempts:i=10}={}){let r=e();for(i-=1;!r&&i>0;)await te(t),r=e(),i-=1;return r}const re=0,ne=1,se=2,ae=3,oe=4,ce=5;async function le(){let e=re;return new Promise((t=>{try{if(!navigator.permissions)return e=oe,void t(e);if("undefined"==typeof Notification)return e=ce,void t(e);(async function(){return Promise.race([de(),te(100,!0)])})().then((i=>{e=i?se:ne,t(e)})).catch((i=>{e=ae,t(e),window.reportError(i)}))}catch(i){e=ae,t(e),window.reportError(i)}}))}async function de(){const e=await navigator.permissions.query({name:"notifications"});return"denied"===Notification.permission&&["prompt","granted"].includes(e.state)}const ue=function(e){let t,i=!1;return function(){return i||(t=e(),i=!0),t}}(le);async function me(){try{if(navigator.getBattery&&"function"==typeof navigator.getBattery){return(await navigator.getBattery()).level}return}catch{return}}function he(){return window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone}async function fe(){let e;return await async function(){return await ue()===se}()?e="headless":window.navigator.webdriver&&(e="webdriver"),e}const pe=()=>performance.getEntriesByType(k.NAVIGATION)[0]||{};function Ee(e){const t=e&&e.serverTiming,i=t&&t.find((({name:e})=>"RequestID"===e));return i&&i.description||""}let ve,be=[];function ge(e){ve||function(){let e=new MessageChannel;ve=function(){this.postMessage(void 0)}.bind(e.port2),e.port1.onmessage=()=>{const e=be;be=[];const t=performance.now();for(let i=0;i<e.length;i++)e[i](t)},e=null}(),be.push(e),1===be.length&&requestAnimationFrame(ve)}let _e=null;function Te(){if("boolean"==typeof _e)return _e;try{_e=!!localStorage.getItem("rumTrackerDebug")}catch(e){_e=!1}return _e||!1}class we{constructor(e){Object.defineProperty(this,"_config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_collectedEntries",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this._config=e,this._observer=new PerformanceObserver(this._observeEntries.bind(this)),this._config.autoStart&&this.start(),this._config.stopEvent&&document.addEventListener(this._config.stopEvent,this.stop.bind(this))}_observeEntries(e){e.getEntries().forEach((e=>{let t=!0;"function"==typeof this._config.filterCallback&&(t=this._config.filterCallback(e)),t&&(this._collectedEntries.push(e),"function"==typeof this._config.processCallback&&this._config.processCallback(e,this._collectedEntries))}))}getCollectedEntries(){return this._collectedEntries}start(){this._observer.observe({type:this._config.type,buffered:!0})}stop(){this._observer.disconnect()}}const ye=new class{get firstHiddenTime(){return this._firstHiddenTime}constructor(){if(Object.defineProperty(this,"_firstHiddenTime",{enumerable:!0,configurable:!0,writable:!0,value:-1}),this._firstHiddenTime=this.initHiddenTime(),this._firstHiddenTime>0){const e=t=>{"hidden"===document.visibilityState&&(this._firstHiddenTime=t.timeStamp,window.removeEventListener("visibilitychange",e,!0))};window.addEventListener("visibilitychange",e,!0)}}initHiddenTime(){let e=1/0;return"hidden"!==document.visibilityState||document.prerendering||(e=0),e}},Ae=e=>e.renderTime||e.loadTime,Ie=e=>{if(!e)return[];const t=[];let i=e;for(;i.parentNode&&"BODY"!==i.nodeName;){const e=i.getAttribute("data-widget");e&&t.push(e),i=i.parentNode}return t},Oe=()=>pe().loadEventEnd;var Pe;!function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.EMPTY_ENTRY_LIST=1]="EMPTY_ENTRY_LIST",e[e.PAGE_OPENED_IN_BACKGROUND=2]="PAGE_OPENED_IN_BACKGROUND",e[e.PAGE_MOVED_TO_BACKGROUND=3]="PAGE_MOVED_TO_BACKGROUND",e[e.LCP_IS_GREATER_THAN_NAV_TOTAL_TIME=4]="LCP_IS_GREATER_THAN_NAV_TOTAL_TIME",e[e.LCP_ENTRY_TIME_PROPS_MISSING=5]="LCP_ENTRY_TIME_PROPS_MISSING",e[e.TAB_CLOSING=6]="TAB_CLOSING",e[e.SEND_FULL_DATA_AFTER_BEFORE_UNLOAD=7]="SEND_FULL_DATA_AFTER_BEFORE_UNLOAD"}(Pe||(Pe={}));const Le={prerendering:!1,waitLcpTimeout:1e3,waitUntilPromise:null};class Re{constructor(e){Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"LCP",{enumerable:!0,configurable:!0,writable:!0,value:{entries:[]}}),Object.defineProperty(this,"CLS",{enumerable:!0,configurable:!0,writable:!0,value:{entries:[]}}),Object.defineProperty(this,"FID",{enumerable:!0,configurable:!0,writable:!0,value:{entries:[]}}),Object.defineProperty(this,"LT",{enumerable:!0,configurable:!0,writable:!0,value:{entries:[]}}),Object.defineProperty(this,"clsObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lcpObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fidObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ltObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lcpAspects",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lastLcpEntry",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"zeroLcpReason",{enumerable:!0,configurable:!0,writable:!0,value:Pe.UNSPECIFIED}),this.config={...Le,...e},this.lcpObserver=new PerformanceObserver((e=>{this.collectLcp(e)})),this.clsObserver=new PerformanceObserver((e=>{this.collectEntries(e,this.CLS)})),this.fidObserver=new PerformanceObserver((e=>{this.collectEntries(e,this.FID)})),this.ltObserver=new PerformanceObserver((e=>{this.collectEntries(e,this.LT)})),this.lcpObserver.observe({type:k.LCP,buffered:!0}),this.clsObserver.observe({type:k.CLS,buffered:!0}),this.fidObserver.observe({type:k.FID,buffered:!0}),this.ltObserver.observe({type:k.LONGTASK,buffered:!0})}stopCollecting(){this.lcpObserver.disconnect(),this.clsObserver.disconnect(),this.fidObserver.disconnect(),this.ltObserver.disconnect()}collectEntries(e,t){e.getEntries().forEach((e=>{t.entries.push(e)}))}collectLcp(e){const t=this.config.getLcpContextCallback?.();e.getEntries().forEach((e=>{this.LCP.entries.push({lcp:e,context:t})}))}calculateLCP(){if(this.zeroLcpReason=Pe.UNSPECIFIED,0===ye.firstHiddenTime)return this.zeroLcpReason=Pe.PAGE_OPENED_IN_BACKGROUND,0;let e=this.LCP.entries;0===e.length&&(this.zeroLcpReason=Pe.EMPTY_ENTRY_LIST),e=e.filter((e=>e.lcp.startTime<ye.firstHiddenTime)),0===e.length&&ye.firstHiddenTime!==1/0&&(this.zeroLcpReason=Pe.PAGE_MOVED_TO_BACKGROUND);const t=Oe();if(!this.config.prerendering){const i=e.filter((e=>Ae(e.lcp)<=t+this.config.waitLcpTimeout));this.zeroLcpReason===Pe.UNSPECIFIED&&0===i.length&&(this.zeroLcpReason=Pe.LCP_IS_GREATER_THAN_NAV_TOTAL_TIME)}this.lastLcpEntry=e[e.length-1];const i=this.lastLcpEntry?Ae(this.lastLcpEntry?.lcp):0;return this.zeroLcpReason===Pe.UNSPECIFIED&&null==i&&(this.zeroLcpReason=Pe.LCP_ENTRY_TIME_PROPS_MISSING),i}async waitForFirstLCP(){return await ie((()=>this.LCP.entries.length>0),{timeout:this.config.waitLcpTimeout/20,attempts:20,label:"LCP"})}async waitUntilTimeout(){const e=[te(this.config.waitLcpTimeout)];this.config.waitUntilPromise&&e.push(this.config.waitUntilPromise),await Promise.race(e);return this.LCP.entries.length>0}async startCalculateLcpAspects(){const e=this.lastLcpEntry?.lcp,t=e?.element,i=t?.localName||"",r=t?.currentSrc||"",n=Array.from(t?.classList||[]).map((e=>"."+e)).join(""),s=Math.round(window.scrollY);if(this.lcpAspects={loadTime:e?.loadTime||0,renderTime:e?.renderTime||0,widgets:t?Ie(t):[],size:e?.size||0,tag:i,url:r,className:n,scrollPosition:s,zeroValueReason:this.zeroLcpReason,zeroValueReasonExperiment:this.zeroLcpReason},r){await ie((()=>performance.getEntriesByName(r).length>0),{label:"lcpAspects"});const e=performance.getEntriesByName(r)[0];this.lcpAspects.networkTiming=e,this.lcpAspects.widgets=t?Ie(t):[]}}calculateCLS(){const e=Oe();return this.CLS.entries.reduce(((t,i)=>i.startTime<=e&&!i.hadRecentInput?t+i.value:t),0)}calculateFID(){const e=this.FID.entries[0];return e?e.processingStart-e.startTime:0}calculateLT(){return this.LT.entries.length}async waitWebVitals(){return this.calculateLCP(),this.config.waitUntilPromise?await this.waitUntilTimeout():this.lastLcpEntry&&!this.config.prerendering||await this.waitForFirstLCP(),this.calculateLCP(),this.stopCollecting(),await this.startCalculateLcpAspects(),this.flushWebVitals()}flushWebVitals(e=!1){const t={cls:this.calculateCLS(),lcp:this.calculateLCP(),fid:this.calculateFID(),lt:this.calculateLT(),lcpAspects:void 0,lcpContext:this.lastLcpEntry?.context};this.lcpAspects||this.startCalculateLcpAspects();const i=[Pe.PAGE_OPENED_IN_BACKGROUND,Pe.PAGE_MOVED_TO_BACKGROUND];return e&&this.lcpAspects&&!i.includes(this.lcpAspects.zeroValueReason)&&(this.lcpAspects.zeroValueReasonExperiment=Pe.TAB_CLOSING),t.lcpAspects=this.lcpAspects,t}}var Ce;!function(e){e.IMAGES="images",e.SCRIPTS="scripts",e.CSS="css",e.FONTS="fonts",e.JSON="json",e.VIDEOS="videos",e.XHR="fetches"}(Ce||(Ce={}));const Se=e=>(e=>/\.css$/.test(e.name))(e)?Ce.CSS:(e=>/\.woff2?$/.test(e.name))(e)?Ce.FONTS:(e=>{const t=e.initiatorType===V.IMG,i=e.initiatorType===V.CSS&&/.(jpe?g|png|webp)/i.test(e.name);return t||i})(e)?Ce.IMAGES:(e=>/\.json$/.test(e.name))(e)?Ce.JSON:(e=>/\.js$/.test(e.name)||e.initiatorType===V.SCRIPT)(e)?Ce.SCRIPTS:(e=>X(e))(e)?Ce.VIDEOS:$(e)?Ce.XHR:void 0;class Me{constructor(e){Object.defineProperty(this,"_config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_enabledBuffers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"$debugAllResources",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"stopCollectEntries",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this._observer.disconnect()}}),this._config=e,this._enabledBuffers=(e=>{const t=new Map,i=i=>{t.set(i,new ee({sendMethod:t=>e.sendCallback(t,i)}))};return e.trackImages&&i(Ce.IMAGES),e.trackScripts&&i(Ce.SCRIPTS),e.trackCss&&i(Ce.CSS),e.trackFonts&&i(Ce.FONTS),e.trackJson&&i(Ce.JSON),(e.trackVideos||e.trackVideosForTile)&&i(Ce.VIDEOS),e.trackXhr&&i(Ce.XHR),t})(this._config);this._observer=new PerformanceObserver((e=>{this._collectEntries(e)})),document.addEventListener("pagehide",this.stopCollectEntries)}_collectEntry(e){Te()&&this.$debugAllResources.push(e);const t=Se(e);if(t){const i=this._enabledBuffers.get(t);if(t===Ce.VIDEOS&&!K(e.name,!!this._config.trackVideosForTile,!!this._config.trackVideos))return;i?.add(e)}}_collectEntries(e){e.getEntries().forEach(this._collectEntry.bind(this))}startCollectEntries(){this._observer.observe({type:"resource",buffered:!0})}}function Ne(e){if(e)return Number(e.getAttribute("data-widget-id"))||void 0}function De(e){if(e)return e.getAttribute("data-state-id")||void 0}function ke(e){return{startTime:e.startTime,duration:e.duration,invoker:e.invoker,invokerType:e.invokerType,forcedStyleAndLayoutDuration:e.forcedStyleAndLayoutDuration,pauseDuration:e.pauseDuration,sourceUrl:e.sourceURL,sourceFunctionName:e.sourceFunctionName,sourceCharPosition:e.sourceCharPosition,windowAttribution:e.windowAttribution}}function Ve(e){return{startTime:e.startTime,duration:e.duration,blockingDuration:e.blockingDuration,renderStart:e.renderStart,styleAndLayoutStart:e.styleAndLayoutStart,scripts:(e.scripts||[]).map(ke)}}function Fe(e,t){const i=Ne(e),r=De(e);let n;if(t){const i=e.__vue__?.$data?.widgetsToMount;let r;i&&Object.prototype.hasOwnProperty.call(i,t)&&(r=i[t]),r&&r.paginationIndex&&(n=r.paginationIndex)}return{paginatorWidgetId:i,paginatorStateId:r,pageIndex:n}}class je{constructor(e){Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inpMetric",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"inpContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"htmlElementRelatedAspects",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inpAspectsCache",{enumerable:!0,configurable:!0,writable:!0,value:null}),this.config=e||{},this.htmlElementRelatedAspects={widgets:[],closestWidgetId:void 0,htmlElementSelector:void 0},function(e,i){t||(t=l("long-animation-frame",M)),I((function(t){var i=function(e){var t=e.entries[0],i=R.get(t),r=P.get(i),s=t.processingStart,o=r.processingEnd,c=r.entries.sort((function(e,t){return e.processingStart-t.processingStart})),l=F(t.startTime,o),d=e.entries.find((function(e){return e.target})),u=d&&d.target||C.get(t.interactionId),m=[t.startTime+t.duration,o].concat(l.map((function(e){return e.startTime+e.duration}))),h=Math.max.apply(Math,m),f={interactionTarget:a(u),interactionTargetElement:u,interactionType:t.name.startsWith("key")?"keyboard":"pointer",interactionTime:t.startTime,nextPaintTime:h,processedEventEntries:c,longAnimationFrameEntries:l,inputDelay:s-t.startTime,processingDuration:o-s,presentationDelay:Math.max(h-o,0),loadState:n(t.startTime)};return Object.assign(e,{attribution:f})}(t);e(i)}),i)}((e=>{this.inpMetric=e,this.inpContext=this.config.getINPContextCallback?.();const t=function(e){let t=null;return t=e.interactionTargetElement?e.interactionTargetElement:e.processedEventEntries.find((e=>!!e.target))?.target??null,t}(e.attribution);this.htmlElementRelatedAspects=function(e){if(!e)return{widgets:[],closestWidgetId:void 0,htmlElementSelector:void 0};const t=[];let i=null;const r=[];let n=e;for(;n&&n.parentNode&&"BODY"!==n.nodeName;){const e=n.getAttribute("data-widget");if(e){const s={name:e,widgetId:void 0,metaInfo:void 0};if(t.push(s),1===t.length&&(i=n),"paginator"===e){const e=Fe(n,r.length>0?r[r.length-1].paginatorStateId:De(i));e&&(r.push(e),s.widgetId=e.paginatorWidgetId,s.metaInfo={pageIndex:e.pageIndex||-2})}}n=n.parentElement}const s=i?Ne(i):void 0,a=function(e,t,i){let r=[],n=0,s=e;for(;s&&s.parentNode&&"BODY"!==s.nodeName&&s!==t;){const e=s.id;let t="";const a=s.nodeName.toLowerCase();if(e)t=`${a}#${e}`;else{const e=s.classList.value.trim();t=`${a}${e.length>0?"."+e.replace(/\s+/g,"."):""}`}if(n+=t.length,n>i)break;r.push(t),s=s.parentNode}return r=r.reverse(),r}(e,i??document.body,200).join(">");return s&&(t[0].widgetId=s),{widgets:t,closestWidgetId:s,htmlElementSelector:a}}(t),this.inpAspectsCache=null,Te()&&console.warn("inp",this.inpMetric)}),{reportAllChanges:!0})}getINPValue(){const e=this.inpMetric?.value;return e}getINPAspects(){if(this.inpAspectsCache)return this.inpAspectsCache;const e=this.inpMetric;if(!e)return;const t=e.entries[0],i=e.attribution,r={...this.htmlElementRelatedAspects,inp:e.value,navigationType:e.navigationType,loadState:i.loadState,eventName:t.name,interactionTime:i.interactionTime,inputDelay:i.inputDelay,processingDuration:i.processingDuration,nextPaintTime:i.nextPaintTime,longAnimationFrames:(i.longAnimationFrameEntries||[]).map(Ve)};return this.inpAspectsCache=r,r}getINPContext(){return this.inpContext}}class He{constructor(){Object.defineProperty(this,"observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"entries",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.observer=new PerformanceObserver((e=>{this.entries=e.getEntries(),this.observer.disconnect()})),this.observer.observe({type:"element",buffered:!0})}async collectData(){if(!document||!document.querySelectorAll("[elementtiming]").length)return[];if(await ie((()=>this.entries.length>0)),!this.entries.length)return[];const e=[],t=new Set;let i=0;for(;e.length<=5&&i<this.entries.length;){const r=this.entries[i],n=r.identifier;t.has(n)||(t.add(n),e.push(r)),i++}return e.map((e=>({name:e.identifier.replace("lcp_eltiming_",""),loadTime:e.loadTime,renderTime:e.renderTime,networkTiming:performance.getEntriesByName(e.url)[0]})))}}class Ge{constructor(){Object.defineProperty(this,"startTime",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"lastFrameTime",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"totalFrames",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"lastFrameFps",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"minFps",{enumerable:!0,configurable:!0,writable:!0,value:Number.MAX_SAFE_INTEGER}),Object.defineProperty(this,"maxFps",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"continue",{enumerable:!0,configurable:!0,writable:!0,value:!0})}reset(){this.continue=!0;const e=performance.now();this.startTime=e,this.lastFrameTime=e,this.totalFrames=0,this.lastFrameFps=0,this.minFps=Number.MAX_SAFE_INTEGER,this.maxFps=0}start(){this.reset();const e=()=>{this.totalFrames++;const t=performance.now(),i=t-this.lastFrameTime;this.lastFrameFps=1e3/i,this.minFps=Math.min(this.minFps,this.lastFrameFps),this.maxFps=Math.max(this.maxFps,this.lastFrameFps),this.lastFrameTime=t,this.continue&&window.requestAnimationFrame(e)};window.requestAnimationFrame(e)}stop(){this.continue=!1}get avgFps(){return 1e3*this.totalFrames/(this.lastFrameTime-this.startTime)}getResult(){return{last:this.lastFrameFps,min:this.minFps,max:this.maxFps,avg:this.avgFps}}}function We(e,t){return window.requestIdleCallback&&"function"==typeof window.requestIdleCallback?window.requestIdleCallback(e,t):setTimeout(e,t?.timeout??1e3)}const Ue=["adsense","google_ad"],Ye=()=>Ue[Math.floor(Math.random()*Ue.length)];let xe;const Be=async()=>{void 0===xe&&We((async()=>{let e=(()=>{const e=document.createElement("div");return e.id=`${Ye()}`,e.className=`${Ye()}`,e.style.height="1px",e.style.width="1px",document.body.appendChild(e),e})();xe=await ie((()=>{return(t=e)&&(0===t.offsetHeight||0===t.offsetWidth||0===t.clientHeight||0===t.clientWidth||"hidden"===t.style.display||"none"===t.style.visibility||0===parseFloat(t.style.opacity));var t}),{timeout:100,attempts:20}),We((()=>{try{document.body.removeChild(e)}catch(e){}finally{e=null}}),{timeout:1e4})}),{timeout:1e4})},qe=Object.freeze({GALLERY_VIDEO_SELECT_MANUALLY:"pdpClickGalleryItem",GALLERY_NEXT_VIDEO:"pdpNextGalleryItem",GALLERY_PREV_VIDEO:"pdpPrevGalleryItem",GALLERY_MODAL_VIDEO_SELECT_MANUALLY:"pdpClickModalGalleryItem",GALLERY_MODAL_NEXT_VIDEO:"pdpNextModalGalleryItem",GALLERY_MODAL_PREV_VIDEO:"pdpPrevModalGalleryItem",GALLERY_OPEN_MODAL:"pdpClickOpenModalGallery",REVIEWS_MODAL_OPEN:"reviewsClickOpenModal",REVIEWS_MODAL_NEXT_VIDEO:"reviewsNextSlideCarousel",REVIEWS_MODAL_PREV_VIDEO:"reviewsPrevSlideCarousel",REVIEW_PREVIEW_HOVER:"reviewsHoverTile",REVIEW_PREVIEW_CLICK:"reviewsClickTile",SEARCH_TILE_IN_VIEWPORT:"naviVideoAddInViewport",SEARCH_TILE_SWIPE:"naviVideoAddInQueueOnSwipe",SEARCH_TILE_RESET_IMAGE:"naviVideoAddInQueueOnResetImage",SEARCH_TILE_PLAYING:"naviVideoIsPlaying"}),Xe=Object.freeze({UNSPECIFIED:"",GALLERY_VIDEO_COVER_AUTOPLAY:"gallery_video_cover_autoplay",ADV_VIDEO_AUTOPLAY:"adv_video_autoplay",GALLERY_VIDEO_SELECT_MANUALLY:"gallery_video_select_manually",GALLERY_NEXT_VIDEO:"gallery_next_video",GALLERY_PREV_VIDEO:"gallery_prev_video",GALLERY_MODAL_VIDEO_SELECT_MANUALLY:"gallery_modal_video_select_manually",GALLERY_MODAL_NEXT_VIDEO:"gallery_modal_next_video",GALLERY_MODAL_PREV_VIDEO:"gallery_modal_prev_video",GALLERY_OPEN_MODAL:"gallery_open_modal",REVIEWS_MODAL_OPEN:"reviews_modal_open",REVIEWS_MODAL_NEXT_VIDEO:"reviews_modal_next_video",REVIEWS_MODAL_PREV_VIDEO:"reviews_modal_prev_video",REVIEW_PREVIEW_HOVER:"review_preview_tile_hover",REVIEW_PREVIEW_CLICK:"review_preview_click",SEARCH_TILE_IN_VIEWPORT:"search_tile_in_viewport",SEARCH_TILE_SWIPE:"search_tile_swipe",SEARCH_TILE_RESET_IMAGE:"search_tile_reset_image",SEARCH_TILE_PLAYING_UNSPECIFIED:"search_tile_unspecified"}),Ke=Object.freeze({[qe.GALLERY_VIDEO_SELECT_MANUALLY]:Xe.GALLERY_VIDEO_SELECT_MANUALLY,[qe.GALLERY_NEXT_VIDEO]:Xe.GALLERY_NEXT_VIDEO,[qe.GALLERY_PREV_VIDEO]:Xe.GALLERY_PREV_VIDEO,[qe.GALLERY_MODAL_VIDEO_SELECT_MANUALLY]:Xe.GALLERY_MODAL_VIDEO_SELECT_MANUALLY,[qe.GALLERY_MODAL_NEXT_VIDEO]:Xe.GALLERY_MODAL_NEXT_VIDEO,[qe.GALLERY_MODAL_PREV_VIDEO]:Xe.GALLERY_MODAL_PREV_VIDEO,[qe.GALLERY_OPEN_MODAL]:Xe.GALLERY_OPEN_MODAL,[qe.REVIEWS_MODAL_OPEN]:Xe.REVIEWS_MODAL_OPEN,[qe.REVIEWS_MODAL_NEXT_VIDEO]:Xe.REVIEWS_MODAL_NEXT_VIDEO,[qe.REVIEWS_MODAL_PREV_VIDEO]:Xe.REVIEWS_MODAL_PREV_VIDEO,[qe.SEARCH_TILE_IN_VIEWPORT]:Xe.SEARCH_TILE_IN_VIEWPORT,[qe.SEARCH_TILE_SWIPE]:Xe.SEARCH_TILE_SWIPE,[qe.SEARCH_TILE_RESET_IMAGE]:Xe.SEARCH_TILE_RESET_IMAGE,[qe.SEARCH_TILE_PLAYING]:Xe.SEARCH_TILE_PLAYING_UNSPECIFIED,[qe.REVIEW_PREVIEW_HOVER]:Xe.REVIEW_PREVIEW_HOVER,[qe.REVIEW_PREVIEW_CLICK]:Xe.REVIEW_PREVIEW_CLICK}),$e=12e5;class ze{constructor(e){Object.defineProperty(this,"_config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_loadedVideoTimings",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"_awaitedUrls",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"_deletedVideoTimings",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"stopCollectEntries",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this._observer.disconnect()}}),this._config=e,this._observer=new PerformanceObserver(this._collectEntries.bind(this)),this.startCollectEntries(),setInterval((()=>{"function"==typeof requestIdleCallback?requestIdleCallback((()=>{this._clearOldTimings()})):this._clearOldTimings()}),18e5)}startCollectEntries(){this._observer.observe({type:"resource",buffered:!0})}_collectEntries(e){e.getEntries().forEach(this._collectEntry.bind(this))}_collectEntry(e){if(X(e)&&K(e.name,!!this._config.trackMediaPlayerMetricsForTile,!!this._config.trackMediaPlayerMetrics)){const t=e.name;let i=this._loadedVideoTimings.get(t);i||(i=[],this._loadedVideoTimings.set(t,i)),i.push(e)}}getResourceTiming(e,t){const i=this._loadedVideoTimings.get(e);if(!i)return null;const r=i.find((e=>e.startTime>=t));return r??null}async waitResourceTiming(e,t,i=6e4){let r=this._awaitedUrls.get(e)??0;this._awaitedUrls.set(e,r+1);const n=await async function(e,{timeout:t=50,attempts:i=10}={}){let r=e();for(i-=1;null===r&&i>0;)await te(t),r=e(),i-=1;return r}((()=>this.getResourceTiming(e,t)),{timeout:i/10,attempts:10});return r=this._awaitedUrls.get(e)??0,this._awaitedUrls.set(e,r-1),n}clearResourceTiming(e){const t=this._loadedVideoTimings.get(e.name);if(!t)return;const i=t.findIndex((t=>t===e));i>=0&&(t.splice(i,1),Te()&&this._addDeletedTiming(e))}_clearOldTimings(){const e=[],t=performance.now();this._loadedVideoTimings.forEach(((i,r)=>{if(this._awaitedUrls.has(r))return;const n=i.filter((e=>e.startTime>=t-$e));if(Te()){const e=i.filter((e=>e.startTime<t-$e));e.forEach(this._addDeletedTiming)}0===n.length?e.push(r):this._loadedVideoTimings.set(r,n)})),e.length===this._loadedVideoTimings.size?this._loadedVideoTimings.clear():e.forEach((e=>{this._loadedVideoTimings.delete(e)}))}_addDeletedTiming(e){const t=e.name;let i=this._deletedVideoTimings.get(t);i||(i=[],this._deletedVideoTimings.set(t,i)),i.push(e)}}var Je,Qe;!function(e){e.OTHER="other",e.REVIEW_PREVIEW="review-preview",e.TILE="tile",e.ADV="advertisement",e.REVIEW="review",e.GALLERY="gallery"}(Je||(Je={})),function(e){e[e.TILE=5]="TILE",e[e.REVIEW=8]="REVIEW",e[e.GALLERY=9]="GALLERY",e[e.REVIEW_PREVIEW=10]="REVIEW_PREVIEW",e[e.ADV=11]="ADV",e[e.OTHER=12]="OTHER",e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.VIDEO=1]="VIDEO",e[e.FEED=2]="FEED",e[e.STREAM=3]="STREAM",e[e.PDP=4]="PDP",e[e.TILE_CATALOG=6]="TILE_CATALOG",e[e.ADVERTISEMENT=7]="ADVERTISEMENT"}(Qe||(Qe={}));const Ze=Object.freeze({INIT:"mediaPlayerInit",LOADED_METADATA:"mediaPlayerLoadedMetadata",LOADED_DATA:"mediaPlayerLoadedData",CAN_PLAY:"mediaPlayerCanPlay",CAN_PLAY_THROUGH:"mediaPlayerCanPlayThrough",FIRST_PLAYBACK_START:"mediaPlayerFirstPlay",FIRST_PLAYBACK_END:"mediaPlayerFirstEnded",METRICS_UPDATE:"mediaPlayerMetricsUpdate",URLS_UPDATE:"mediaPlayerUrlsUpdate",TIMEOUT_ERROR:"mediaPlayerFirstPlayTimeoutError",FATAL_ERROR:"mediaPlayerFatalError"});async function et(e){const{event:t,resourceTimingStore:i,pendingMetrics:r}=e,n=[...t.urls],s=t.playerProps?.src;s&&n[0]!==s&&n.splice(0,0,s);const a=n.map((e=>({url:e,networkTiming:null}))),{files:o,manifestTiming:c}=tt(a),l=t.externalMeta?.productType,d=(e=>e&&{[Je.ADV]:Qe.ADV,[Je.GALLERY]:Qe.GALLERY,[Je.OTHER]:Qe.OTHER,[Je.REVIEW]:Qe.REVIEW,[Je.REVIEW_PREVIEW]:Qe.REVIEW_PREVIEW,[Je.TILE]:Qe.TILE}[e]||Qe.UNSPECIFIED)(l),u={videoRequestId:t.mediaPlayerId,videoProductType:d,widgetName:t.externalMeta?.widgetName,videoResolution:t.videoResolution,playerLoadTime:t.loadTime,startupTime:t.startupTime,viewTime:t.viewTime,stallCount:t.stallCount,stallDuration:t.stallDuration,initiatorName:t.initiatorName,effectiveStartupTime:t.effectiveStartupTime,videoIndex:t.videoIndex,errorDetails:{count:t.errorsCount,isTimeoutError:t.timeoutError,fatalErrorType:t.fatalError},files:o,manifestTiming:c};r.set(t.mediaPlayerId,u);const m=await async function(e,t,i){return Promise.all(e.map((async e=>({url:e,networkTiming:await i.waitResourceTiming(e,t)}))))}(n,t.eventTimings[Ze.INIT]??0,i);m.forEach((({url:e,networkTiming:r})=>{t.networkTimings[e]=r,r&&i.clearResourceTiming(r)}));const{files:h,manifestTiming:f}=tt(m);let p=null;const E=`widgetName: ${t.externalMeta?.widgetName}, videoUrl: ${n[0]}`;return l?l&&0===d&&(p=new Error(`Неподдерживаемый тип productType: ${l}. ${E}`)):p=new Error(`Не передан productType. ${E}`),p&&window.reportError(p),u.files=h,u.manifestTiming=f,u}function tt(e){const t=[],i=[];return e.forEach((e=>{const r=function(e){let t={networkTiming:{name:e.url}};return e.networkTiming&&(t={networkTiming:e.networkTiming}),t}(e),n=r.networkTiming.name,s=n.endsWith(j),a=n.endsWith(G);s||a?i.push(r):t.push(r)})),{files:t,manifestTiming:i}}function it(e){return Ke[e]}var rt;!function(e){e.NO_CAN_PLAY_NO_ERRORS="NO_CAN_PLAY_NO_ERRORS",e.AB_NO_TRACK="AB_NO_TRACK",e.GALLERY_PLAYER_NOT_MODAL="GALLERY_PLAYER_NOT_MODAL"}(rt||(rt={}));const nt=[Ze.METRICS_UPDATE,Ze.URLS_UPDATE];class st{constructor(){Object.defineProperty(this,"eventsMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}get(e){return this.eventsMap.get(e)}set(e,t){this.eventsMap.set(e,t)}forEach(e){this.eventsMap.forEach(e)}get allEvents(){return Array.from(this.eventsMap.values())}get tiles(){const e=this.allEvents.filter((e=>e.isTile));return e}get notTiles(){const e=this.allEvents.filter((e=>!e.isTile));return e}}class at{constructor(e){Object.defineProperty(this,"_config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_timingsStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pendingMetrics",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"_mediaPlayerEventsStore",{enumerable:!0,configurable:!0,writable:!0,value:new st}),Object.defineProperty(this,"initiatorEvents",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"lastMetricsUpdates",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"videoCoverAutoplayDetected",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"advBannerAutoplayDetected",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this._config=e,this._timingsStore=new ze({trackMediaPlayerMetrics:e.trackMediaPlayerEvents,trackMediaPlayerMetricsForTile:e.trackMediaPlayerEventsForTile}),this.handleMediaPlayerEvent=this.handleMediaPlayerEvent.bind(this),this.handleInitiatorEvent=this.handleInitiatorEvent.bind(this),Object.values(Ze).forEach((e=>{window.addEventListener(e,this.handleMediaPlayerEvent)})),Object.values(qe).forEach((e=>{window.addEventListener(e,this.handleInitiatorEvent)})),setTimeout((()=>{z(this.sendPendingMetrics.bind(this),!0)}),0)}sendPendingMetrics(){this._pendingMetrics.forEach(((e,t)=>{const i=this._mediaPlayerEventsStore.get(t),r=i?i.eventTimings[Ze.INIT]??0:0;["files","manifestTiming"].forEach((t=>{e[t].forEach((e=>{const t=e.networkTiming.name,i=this._timingsStore.getResourceTiming(t,r);i&&(e.networkTiming=i,this._timingsStore.clearResourceTiming(i))}))})),this._config.sendCallback(e)})),this._pendingMetrics.clear()}handleMediaPlayerEvent(e){(function(e){return e instanceof CustomEvent&&Object.values(Ze).includes(e.type)})(e)&&this.aggregateInfo(e)}aggregateInfo(e){const{type:t,detail:i}=e,r=i.identifier;let n=this._mediaPlayerEventsStore.get(r);if(n||(n={mediaPlayerId:r,urls:[],updates:[],eventTimings:{},networkTimings:{},wasSent:!1,skipReason:null,isTile:void 0,initiatorName:Xe.UNSPECIFIED,errorsCount:0,timeoutError:!1,fatalError:void 0},this._mediaPlayerEventsStore.set(r,n)),!function(e){return!nt.includes(e)}(t)||!n.eventTimings[t]){if(Te())if(e.type===Ze.METRICS_UPDATE){(s=this.lastMetricsUpdates.get(r),a=e.detail,!(s&&a&&s.identifier===a.identifier&&s.errorsCount===a.errorsCount&&s.viewTime===a.viewTime&&s.stallCount===a.stallCount&&s.stallDuration===a.stallDuration))&&(n.updates.push(e),this.lastMetricsUpdates.set(r,e.detail))}else n.updates.push(e);var s,a;if(n.eventTimings[t]=e.detail.timestamp,t===Ze.INIT){n.externalMeta=e.detail.externalMeta,n.playerProps=e.detail.playerProps;const t=B(e.detail.playerProps?.src),i=e.detail.externalMeta.productType===Je.TILE;n.isTile=t||i}else t===Ze.CAN_PLAY?(n.loadTime=e.detail.loadTime,n.startupTime=e.detail.startupTime,n.videoResolution=e.detail.videoResolution):t===Ze.FIRST_PLAYBACK_START||(t===Ze.METRICS_UPDATE?(n.viewTime=e.detail.viewTime,n.stallCount=e.detail.stallCount,n.stallDuration=e.detail.stallDuration,n.errorsCount=e.detail.errorsCount,n.timeoutError=e.detail.errorsDetails.timeoutError??!1,n.fatalError=e.detail.errorsDetails.fatalError??void 0):t===Ze.URLS_UPDATE?n.urls.push(...e.detail.urls):t===Ze.FIRST_PLAYBACK_END?this.sendByKey(r):t===Ze.TIMEOUT_ERROR?(n.timeoutError=!0,n.errorsCount=e.detail.errorsCount):t===Ze.FATAL_ERROR&&(n.fatalError=e.detail.errorsDetails.fatalError,n.errorsCount=e.detail.errorsCount,this.sendByKey(r)))}}handleInitiatorEvent(e){(function(e){return e instanceof CustomEvent&&Object.values(qe).includes(e.type)})(e)&&this.aggregateInitiatorInfo(e)}aggregateInitiatorInfo(e){const{detail:t}=e,i=t.videoIdentifier;let r=this.initiatorEvents.get(i);r||(r=[],this.initiatorEvents.set(i,r)),r.push(e)}async sendByKey(e){const t=this._mediaPlayerEventsStore.get(e);if(!t)throw Error(`Событие с ключом ${e} не зарегистрировано`);if(t.wasSent||null!==t.skipReason)return;if(!(t.fatalError||t.timeoutError)&&!t.eventTimings[Ze.CAN_PLAY])return void(t.skipReason=rt.NO_CAN_PLAY_NO_ERRORS);const i=!!t.isTile&&this._config.trackMediaPlayerEventsForTile,r=!t.isTile&&this._config.trackMediaPlayerEvents;if(!i&&!r)return void(t.skipReason=rt.AB_NO_TRACK);const n=function(e,t,i,r){const n=e.externalMeta;if(!n)return{initiatorName:"",effectiveStartupTime:void 0,videoIndex:void 0,initiatorEventId:void 0,initiatorEvents:[]};const s=n.productType===Je.GALLERY&&!!n.isVideoCover&&"page"===n.location,a=n.videoIdentifier;if(s&&!a&&!i)return{initiatorName:Xe.GALLERY_VIDEO_COVER_AUTOPLAY,effectiveStartupTime:e.eventTimings[Ze.CAN_PLAY],videoIndex:void 0,initiatorEventId:void 0,initiatorEvents:[],videoCoverAutoplayDetected:!0};if(n.productType===Je.ADV&&!r)return{initiatorName:Xe.ADV_VIDEO_AUTOPLAY,effectiveStartupTime:e.eventTimings[Ze.CAN_PLAY],videoIndex:void 0,initiatorEventId:void 0,initiatorEvents:[],advBannerAutoplayDetected:!0};if(!a)return{initiatorName:"",effectiveStartupTime:void 0,videoIndex:void 0,initiatorEventId:void 0,initiatorEvents:[]};if(n.productType===Je.TILE){const i=t.get(a);if(!Array.isArray(i)||0===i.length)return{initiatorName:Xe.SEARCH_TILE_PLAYING_UNSPECIFIED,effectiveStartupTime:void 0,videoIndex:void 0,initiatorEventId:a,initiatorEvents:[]};const r=[qe.SEARCH_TILE_IN_VIEWPORT,qe.SEARCH_TILE_SWIPE,qe.SEARCH_TILE_RESET_IMAGE],n=i.find((e=>r.includes(e.type))),s=i.find((e=>e.type===qe.SEARCH_TILE_PLAYING)),o=e.eventTimings[Ze.CAN_PLAY];let c,l,d=Xe.SEARCH_TILE_PLAYING_UNSPECIFIED;return n&&(d=it(n.type),l=n.detail.queueLength,s&&o&&(c=Math.max(o-s.detail.timestamp,0))),{initiatorName:d,effectiveStartupTime:c,videoIndex:l,initiatorEventId:a,initiatorEvents:i}}let o,c=Xe.UNSPECIFIED;const l=t.get(a);if(Array.isArray(l)&&l.length>0){c=it(l[0].type);const t=e.eventTimings[Ze.CAN_PLAY];t&&(o=t-l[0].detail.timestamp)}return{initiatorName:c,effectiveStartupTime:o,videoIndex:void 0,initiatorEventId:a,initiatorEvents:l??[]}}(t,this.initiatorEvents,this.videoCoverAutoplayDetected,this.advBannerAutoplayDetected);t.initiatorName=n.initiatorName,t.effectiveStartupTime=n.effectiveStartupTime,t.videoIndex=n.videoIndex,t.initiatorEvents=n.initiatorEvents,t.initiatorEventId=n.initiatorEventId,n.videoCoverAutoplayDetected&&(this.videoCoverAutoplayDetected=!0),n.advBannerAutoplayDetected&&(this.advBannerAutoplayDetected=!0);const s=n.initiatorEvents[0],a=[qe.GALLERY_MODAL_VIDEO_SELECT_MANUALLY,qe.GALLERY_MODAL_NEXT_VIDEO,qe.GALLERY_MODAL_PREV_VIDEO];if(s?.type&&a.includes(s.type)&&"page"===t.externalMeta?.location)return void(t.skipReason=rt.GALLERY_PLAYER_NOT_MODAL);const o=await et({event:t,resourceTimingStore:this._timingsStore,pendingMetrics:this._pendingMetrics});this._config.sendCallback(o),this._pendingMetrics.delete(e),t.wasSent=!0}deactivate(){this._mediaPlayerEventsStore.forEach(((e,t)=>{this.sendByKey(t)}))}}const ot={html_head_start:"htmlHeadStart",link_preloaded:"linkPreloaded",meta_loaded:"metaLoaded",link_preconnected:"linkPreconnected",fonts_loaded:"fontsLoaded",css_parsed:"cssParsed",head_html_parsed:"headHtmlParsed",body_html_parsed:"bodyHtmlParsed",HYDRATION_TIME:"appInitEnd"},ct=()=>{const e=[];return Object.keys(ot).forEach((t=>{const i=performance.getEntriesByName(t)[0];i&&e.push({name:t,time:i.startTime})})),e};let lt=0,dt=0,ut=0,mt=0,ht=0,ft=re;function pt(e){let t=e;return t===ce&&(t=oe),t}function Et(){return{blocker:xe,permissions:pt(ft),nativeOnly:!navigator.webdriver,history:window.history.length,scroll:lt,move:dt,touch:ut,click:ht,key:mt,duration:performance.now()}}const vt=()=>{const e=window.__NUXT__?.state?.browser,t=window.__NUXT__?.state?.pageInfo;return{userAgent:e?.browser,browserFamily:e?.family,browserVersion:e?.majorVersion?String(e?.majorVersion):void 0,platform:e?.platform,url:window.location.href,pageType:t?.pageType}};class bt{constructor(e){Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e}async getBrowserData(e){const t=await async function(){const[e,t]=await Promise.all([fe(),me()]),i={deviceBattery:t,testingToolName:e,deviceCores:window.navigator.hardwareConcurrency,deviceRam:void 0,downlink:void 0,effectiveConnectionType:void 0,isPwa:he(),referrer:window.document.referrer,roundTripTime:void 0,screenPixelDensity:window.devicePixelRatio,screenResolutionX:window.screen.width,screenResolutionY:window.screen.height};return void 0!==window.navigator.deviceMemory&&(i.deviceRam=window.navigator.deviceMemory),void 0!==window.navigator.connection?.downlink&&(i.downlink=window.navigator.connection.downlink),void 0!==window.navigator.connection?.effectiveType&&(i.effectiveConnectionType=window.navigator.connection.effectiveType),void 0!==window.navigator.connection?.rtt&&(i.roundTripTime=window.navigator.connection.rtt),i}();return{...t,trackerVersion:"5.2.0",fps:e??void 0}}getCurrentDomStats(){return{domElementsCount:document.querySelectorAll("*").length,widgetsCount:void 0,allocatedJsHeapMemory:window.performance.memory?.totalJSHeapSize,usedJsHeapMemory:window.performance.memory?.usedJSHeapSize}}async createCommonBlocks(e){return{browser:await this.getBrowserData(e)}}async createHtmlEvent(e){const{htmlRequestId:t,htmlRequestIdTimestamp:i}=this.config,r=await this.createCommonBlocks(e.fps),n=this.getCurrentDomStats();return{...r,htmlEvent:{requestId:t,requestIdTimestamp:i,navigationTiming:pe(),webVitals:e.webVitals,performanceMarks:e.performanceMarks,elements:e.elements,domStats:n}}}async createAssetsEvent(e,t){const{htmlRequestId:i,htmlRequestIdTimestamp:r}=this.config;return{...await this.createCommonBlocks(),htmlEvent:{requestId:i,requestIdTimestamp:r,assets:{[t]:e.map((e=>({networkTiming:e})))}}}}async createPaginationEvent(e){return{...await this.createCommonBlocks(),paginationEvents:e}}async createStatEvent(e){const{htmlRequestId:t,htmlRequestIdTimestamp:i}=this.config;return{...await this.createCommonBlocks(),statEvent:{requestId:t,requestIdTimestamp:i,...Et(),inp:e}}}async createStatAndINPAspectsEvents(e){const{htmlRequestId:t,htmlRequestIdTimestamp:i}=this.config,r=await this.createCommonBlocks(),n={...r,statEvent:{requestId:t,requestIdTimestamp:i,...Et(),inp:e.inp}},s=vt();return{statEvent:n,inpAspectsEvent:{browser:{...r.browser,...s},inpAspects:{requestId:t,requestIdTimestamp:i,...e}}}}async createComposerActionEvent(e){const{htmlRequestId:t,htmlRequestIdTimestamp:i}=this.config;return{...await this.createCommonBlocks(),asyncActionEvent:{requestId:t,requestIdTimestamp:i,actions:e.map((e=>({requestId:Ee(e),networkTiming:e})))}}}async createVideoEvent(e){const{htmlRequestId:t}=this.config;return{...await this.createCommonBlocks(),videoEvents:[{requestId:t,...e}]}}async createAsyncWidgetsEvent(e){if(!e.length)return null;return{...await this.createCommonBlocks(),asyncWidgetsEvent:{requestId:this.config.htmlRequestId,widgets:e}}}async createComplexActionsEvent(e){const t=await this.createCommonBlocks(),i=vt(),r=window.__NUXT__?.state?.requestID;return{browser:{...t.browser,...i},complexActions:{requestId:r,actions:e}}}}class gt{constructor(e){Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"markObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"paginationMarks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"resourceObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"composerPageRequests",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"paginationEventBuffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"collectNetworkResources",{enumerable:!0,configurable:!0,writable:!0,value:e=>{e.getEntries().forEach((e=>{const t=(e=>$(e)&&/\/entrypoint-api.bx\/page\/json/.test(e.name))(e);t&&this.composerPageRequests.push(e)}))}}),Object.defineProperty(this,"collectMarks",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=e.getEntries(),i=t.filter((e=>["paginationEnd","paginationStart"].includes(e.name)));this.paginationMarks=this.paginationMarks.concat(i);const r=t.filter((e=>"paginationEnd"===e.name));r.forEach((e=>{const t=this.createPaginationEvent(e);t&&this.paginationEventBuffer.add(t)}))}}),Object.defineProperty(this,"stopCollectMarks",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.markObserver.disconnect()}}),Object.defineProperty(this,"stopCollectResources",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.resourceObserver.disconnect()}}),this.config=e,this.paginationEventBuffer=new ee({sendTimeout:5e3,sendMethod:this.config.sendCallback}),this.markObserver=new PerformanceObserver(this.collectMarks),this.startCollectMarks(),this.resourceObserver=new PerformanceObserver(this.collectNetworkResources),this.startCollectResources(),document.addEventListener("pagehide",(()=>{this.stopCollectMarks(),this.stopCollectResources()}))}createPaginationEvent(e){const t=e.detail?.queryUrl||"";if(t){const i=this.paginationMarks.filter((e=>"paginationStart"===e.name)).find((e=>e.detail?.queryUrl===t));if(i?.startTime)return this.createPaginationEntry(t,i,e)}}createPaginationEntry(e,t,i){const r=this.composerPageRequests.find((t=>t.name.includes(e))),n=t.startTime,s=i.startTime-n,a=i.detail.loaderVisibleTime,o=a?a.end-a.start:0,c=t.detail,l=i.detail,d=(u=l.domElementsCount,m=c.domElementsCount,"number"==typeof u&&"number"==typeof m?u-m:void 0);var u,m;if(r){return{pageRequestId:this.config.pageRequestId,requestId:Ee(r),layoutContainer:c.layoutContainer||"",stateId:c.stateId||"",index:c.paginationIndex,totalTime:s,networkTiming:r,loaderVisibleTime:o,domStats:{domElementsCount:d,widgetsCount:l.widgetsOnPage?.length,allocatedJsHeapMemory:l.allocatedJsHeapMemory,usedJsHeapMemory:l.usedJsHeapMemory}}}}startCollectMarks(){this.markObserver.observe({type:"mark",buffered:!0})}startCollectResources(){this.resourceObserver.observe({type:"resource",buffered:!0})}}var _t;!function(e){e.AFTER_PAINT="widgetRenderEnd"}(_t||(_t={}));const Tt=e=>$(e)&&/\/composer-api.bx\/widget\/json/.test(e.name);class wt{constructor(){var e;Object.defineProperty(this,"_resourceObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"createWidgetRenderData",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,i,r,n)=>{const s={};if(e){e.querySelectorAll("img").forEach((e=>{const t=e.getAttribute("src")??void 0,i=n.find((e=>e.name===t));i&&s.mediaLoadMaxTime&&i.responseEnd>s.mediaLoadMaxTime&&(s.mediaLoadMaxTime=i.responseEnd,s.mediaLoadMaxUrl=t)}))}return{widgetName:t,widgetRenderTime:i,isFirstMount:r.isFirstMount,isComposerAsyncWidget:r.isAsyncWidget,...s}}}),Object.defineProperty(this,"createWidgetData",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,i,r,n)=>{const s=n.find((e=>e.name.includes(t))),a={};s&&(a.requestId=Ee(s),a.networkTiming=s);const o={...a,...this.createWidgetRenderData(e,t,i,r,n)};return r.beforePaintAt&&(o.nestedWidgets=[{widgetName:"beforePaint",widgetRenderTime:r.beforePaintAt}]),o}}),Object.defineProperty(this,"getAsyncWidgetsData",{enumerable:!0,configurable:!0,writable:!0,value:()=>{const e=performance.getEntriesByType(k.MARK),t={};e.forEach((e=>{const{name:i,startTime:r,detail:n}=e;if(!(i===_t.AFTER_PAINT))return;const s=n?.stateId;if(!s)return;const a=document.querySelector(`[data-mark=${s}]`),o=this._resourceObserver.getCollectedEntries();if(!a||a.dataset.widget){const e=this.createWidgetData(a,s,r,n,o);e&&(t[s]=e)}else{const e=a.closest("[data-widget]");if(!e)return;const i=e.dataset.widget||"";t[i]||(t[i]={widgetName:i});const c=t[i];c.nestedWidgets||(c.nestedWidgets=[]);const l=this.createWidgetRenderData(a,s,r,n,o);c.nestedWidgets.push(l)}}));return Object.values(t).slice(0,30)}}),this._resourceObserver=new we({type:"resource",autoStart:!0,filterCallback:Tt,processCallback:e})}}var yt;!function(e){e.START="actionStart",e.END="actionEnd"}(yt||(yt={}));class At{constructor(e){Object.defineProperty(this,"marksObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startMarks",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"networkObservers",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"entriesBuffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"collectMarks",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=e.getEntries(),i=t.filter((e=>e.name===yt.START));i.forEach((e=>{const t=e.detail.actionName;if(e.detail.params.isInterval)this.startMarks.set(t,e),this.startNetworkObserver(t,e.detail.params);else{const i={name:t,startTime:e.startTime};this.entriesBuffer.add(i)}}));const r=t.filter((e=>e.name===yt.END));r.forEach((e=>{const t=this.createActionEntry(e);t&&this.entriesBuffer.add(t)}))}}),Object.defineProperty(this,"stopCollectMarks",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.marksObserver.disconnect(),this.networkObservers.forEach((({observer:e,autoDestroyTimer:t})=>{e.disconnect(),clearTimeout(t)}))}}),this.marksObserver=new PerformanceObserver(this.collectMarks),this.entriesBuffer=new ee({sendTimeout:5e3,sendMethod:e}),document.addEventListener("pagehide",this.stopCollectMarks)}createActionEntry(e){const t=e.detail?.actionName,i=t?this.startMarks.get(t):void 0;if(i&&(this.startMarks.delete(t),i.startTime)){return{name:t,startTime:i.startTime,endTime:e.startTime,networkTimings:this.stopNetworkObserver(t,i.detail.params)}}}startNetworkObserver(e,t){if(!t?.composerActionLink)return;const i=this.networkObservers.get(e);if(i){const{observer:e,autoDestroyTimer:t}=i;e.disconnect(),clearTimeout(t)}const r=new PerformanceObserver((i=>{this.saveNetworkEntries(i.getEntries(),e,t)}));r.observe({type:"resource",buffered:!1});const n=window.setTimeout((()=>{r.disconnect(),this.networkObservers.delete(e)}),1e4);this.networkObservers.set(e,{observer:r,autoDestroyTimer:n,entries:[]})}stopNetworkObserver(e,t){const i=this.networkObservers.get(e);if(i){const{observer:r,autoDestroyTimer:n,entries:s}=i;return this.saveNetworkEntries(r.takeRecords(),e,t),r.disconnect(),clearTimeout(n),this.networkObservers.delete(e),s}return[]}saveNetworkEntries(e,t,i){e.forEach((e=>{const r=["fetch","xmlhttprequest"].includes(e.initiatorType),n=!!i&&!!i.composerActionLink&&e.name.includes(`/composer-api.bx/_action/${i.composerActionLink}`);r&&n&&this.networkObservers.get(t)?.entries.push(e)}))}startCollectMarks(){this.marksObserver.observe({type:"mark",buffered:!0})}}class It{constructor(e){Object.defineProperty(this,"_config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_composerActionsBuffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"$debugAllResources",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"stopCollectEntries",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this._observer.disconnect()}}),this._config=e,this._composerActionsBuffer=new ee({sendMethod:this._config.sendCallback});this._observer=new PerformanceObserver((e=>{this._collectEntries(e)})),this.startCollectEntries(),document.addEventListener("pagehide",this.stopCollectEntries)}_collectEntry(e){const t=(e=>$(e)&&/\/composer-api.bx\/_action/.test(e.name))(e);t&&(this._composerActionsBuffer?.add(e),Te()&&this.$debugAllResources.push(e))}_collectEntries(e){e.getEntries().forEach(this._collectEntry.bind(this))}startCollectEntries(){this._observer.observe({type:"resource",buffered:!0})}}class Ot{constructor(e){if(Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"builder",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"paginationObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"assetObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"composerActionsObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"composerAsyncWidgetsObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"complexActionsObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"fpsCounter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vitalsObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inpObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mediaPlayerEventsAggregator",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"useSendBeacon",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"wasSent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lastSentInpAspects",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"$debugSentEventsList",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.getDataForDevTools=this.getDataForDevTools.bind(this),this.config=e,this.vitalsObserver=new Re({prerendering:document.prerendering}),this.inpObserver=new je,this.fpsCounter=new Ge,this.fpsCounter.start(),this.builder=new bt(this.config),!this.config.htmlRequestId&&!Te())return;const t=this.sendPagination.bind(this),i=this.sendAssets.bind(this),r=this.sendVideoMetrics.bind(this),n=this.sendComposerActions.bind(this),s=this.sendComplexActions.bind(this);if(this.assetObserver=new Me({trackJson:e.trackJson,trackFonts:e.trackFonts,trackCss:e.trackCss,trackImages:e.trackImages,trackScripts:e.trackScripts,trackVideos:e.trackVideos,trackVideosForTile:e.trackVideosForTile,trackXhr:e.trackXhr,sendCallback:i}),this.assetObserver.startCollectEntries(),e.trackPagination&&(this.paginationObserver=new gt({pageRequestId:e.htmlRequestId,sendCallback:t})),e.trackMediaPlayerMetrics||e.trackMediaPlayerMetricsForTile){const t=new at({trackMediaPlayerEvents:!!e.trackMediaPlayerMetrics,trackMediaPlayerEventsForTile:!!e.trackMediaPlayerMetricsForTile,sendCallback:r});this.mediaPlayerEventsAggregator=t,window.addEventListener("pagehide",(()=>{t.deactivate()}))}var a;e.trackComposerActions&&(this.composerActionsObserver=new It({sendCallback:n})),this.composerAsyncWidgetsObserver=new wt,this.complexActionsObserver=new At(s),this.complexActionsObserver.startCollectMarks(),setTimeout((()=>{le().then((e=>{ft=e})),Be(),window.addEventListener("scroll",(()=>{lt++}),!0),window.addEventListener("mousemove",(()=>{dt++}),!0),window.addEventListener("touchmove",(()=>{ut++}),!0),window.addEventListener("keydown",(()=>{mt++}),!0),window.addEventListener("click",(()=>{ht++}),!0),z(this.sendStatAndInpAspects.bind(this))}),0),a=()=>{const e=()=>{this.onBeforeUnload()},t=async()=>{await this.onLoad()&&window.removeEventListener("beforeunload",e)};window.addEventListener("beforeunload",e),window.addEventListener("beforeunload",(()=>{this.sendAsyncWidgets()})),"complete"===document.readyState?setTimeout(t,0):window.addEventListener("load",(()=>setTimeout(t,0)))},document.prerendering?window.addEventListener("prerenderingchange",(()=>{a(!0)}),!0):a(!1)}async onLoad(){const e=await this.collectHtmlEventData(!1),t=await this.builder.createHtmlEvent(e);if(this.wasSent){const e=t.htmlEvent.webVitals.lcpAspects;e&&(e.zeroValueReasonExperiment=Pe.SEND_FULL_DATA_AFTER_BEFORE_UNLOAD)}return this.send(t)}async onBeforeUnload(){const e=await this.collectHtmlEventData(!0),t=await this.builder.createHtmlEvent(e),i=this.send(t);return i&&(this.wasSent=!0),i}async collectHtmlEventData(e){const{trackPerformanceMarks:t}=this.config,i=t&&!e;let r,n,s;if(r=e?this.vitalsObserver.flushWebVitals(e):await this.vitalsObserver.waitWebVitals(),t&&(n=(()=>{const e={htmlHeadStart:0,linkPreloaded:0,metaLoaded:0,linkPreconnected:0,fontsLoaded:0,cssParsed:0,headHtmlParsed:0,bodyHtmlParsed:0,appInitEnd:0};for(const[t,i]of Object.entries(ot)){const r=performance.getEntriesByName(t)[0];r&&(e[i]=r.startTime)}return e})()),i){const e=new He;s=await e.collectData()}delete r.lcpAspects?.className,this.fpsCounter.stop();return{webVitals:r,performanceMarks:n,elements:s,fps:this.fpsCounter.getResult().avg}}async sendAssets(e,t){const i=await this.builder.createAssetsEvent(e,t);return this.send(i)}async sendComposerActions(e){const t=await this.builder.createComposerActionEvent(e);return this.send(t)}async sendPagination(e){const t=await this.builder.createPaginationEvent(e);return this.send(t)}async sendVideoMetrics(e){const t=await this.builder.createVideoEvent(e);return this.send(t)}async sendStatAndInpAspects(){const e=this.inpObserver.getINPAspects();if(this.lastSentInpAspects===e){const e=await this.builder.createStatEvent(void 0);return this.send(e)}if(e){const{statEvent:t,inpAspectsEvent:i}=await this.builder.createStatAndINPAspectsEvents(e);return this.lastSentInpAspects=e,this.send(t)&&this.send(i)}return!1}async sendAsyncWidgets(){if(!this.composerAsyncWidgetsObserver)return;const e=this.composerAsyncWidgetsObserver.getAsyncWidgetsData(),t=await this.builder.createAsyncWidgetsEvent(e);t&&this.send(t)}async sendComplexActions(e){const t=await this.builder.createComplexActionsEvent(e);return!t||this.send(t)}send(e){void 0===this.useSendBeacon&&(this.useSendBeacon="object"==typeof navigator&&"function"==typeof navigator.sendBeacon),this.useSendBeacon||e.browser.testingToolName||(e.browser.testingToolName="xhr");const t=JSON.stringify(e);if(Te())try{this.$debugSentEventsList.push(JSON.parse(t))}catch(e){window.reportError(e)}const i=this.useSendBeacon?navigator.sendBeacon(this.config.endpoint,t):function(e,t){const i=window.event&&window.event.type,r="unload"===i||"beforeunload"===i,n="XMLHttpRequest"in window?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");n.open("POST",e,!r),n.withCredentials=!0,n.setRequestHeader("Accept","*/*"),n.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),r||(n.responseType="text");try{n.send(t)}catch(e){return!1}return!0}(this.config.endpoint,t);return i}getDataForDevTools(){return(e=>{const t=pe();return{navigationTiming:t,navigationTimingExt:{ttfb:t.responseStart-t.domainLookupStart,ttlb:t.responseEnd-t.domainLookupStart},webVitals:e.flushWebVitals(),performanceMarks:ct()}})(this.vitalsObserver)}runAfterFramePaint(e){ge(e)}trackWidgetRenderEnd(e,t={}){!function(e,t={}){const i=performance.now();ge((r=>{const n={stateId:e,isAsyncWidget:t.isAsyncWidget||!1,isFirstMount:t.isFirstMount||!1,beforePaintAt:i};performance.mark(_t.AFTER_PAINT,{startTime:r,detail:n})}))}(e,t)}trackActionStart(e,t){!function(e,t){performance.mark(yt.START,{detail:{actionName:e,params:t}})}(e,t)}trackActionEnd(e){!function(e){ge((t=>{performance.mark(yt.END,{startTime:t,detail:{actionName:e}})}))}(e)}}if(window.PerformanceObserver){const e=(()=>{const e=window.__cpmInit__;return{endpoint:`${e.basePath}/perf-metrics-collector/v4/rum/bx/web`,htmlRequestId:Ee(pe()),htmlRequestIdTimestamp:e.requestIdTimestamp,trackCss:!!e.trackAssets,trackFonts:!!e.trackAssets,trackJson:!!e.trackAssets,trackImages:!!e.trackImages,trackMediaPlayerMetrics:!!e.trackMediaPlayerMetrics,trackMediaPlayerMetricsForTile:!!e.trackMediaPlayerMetricsForTile,trackPagination:!0,trackPerformanceMarks:!!e.trackPerformanceMarks,trackScripts:!!e.trackScripts,trackVideos:!!e.trackVideos,trackVideosForTile:!!e.trackVideosForTile,trackComposerActions:!!e.trackAsyncActions,trackXhr:!!e.trackFetchXHRRequestsRum4}})();try{window.$perfTracker=new Ot(e)}catch{}}}();
